# Домашнее задание. Практическая работа

## Дисциплина: ETL-процессы  
**Тема:** Итоговое задание по модулю 3  

### Форма проверки  
Домашнее задание с проверкой преподавателем  

**Имя преподавателя:** Артем Озерков  
**Время выполнения:** 10 часов  

## Цель задания  
Проверить полученные знания и умения по дисциплине «ETL-процессы».  
Научиться реализовывать ETL-процесс, используя инструменты Apache Airflow, PostgreSQL, MongoDB.  

## Инструменты для выполнения ДЗ  
Для выполнения задания понадобятся:
- Apache Airflow
- Базы данных (например, PostgreSQL и MongoDB)

## Правила приёма работы  
Прикрепите в LMS ссылку на выполненное задание в Google Colab или GitHub.  
**Важно:** убедитесь, что по ссылке есть доступ в Google Colab, так как иногда доступ может быть закрыт для другого логина.  

## Критерии оценивания итогового домашнего задания  
**Максимальное количество баллов:** 10  

### Критерии оценивания основного задания  
| Условие | Баллы |
|---------|--------|
| Развёрнута реляционная база данных | 1 балл |
| Развёрнута нереляционная база данных | 1 балл |
| Сгенерированы данные для нереляционной базы данных | 0.5 балла |
| Сформированы пайплайны для репликации в PostgreSQL + Airflow | 2 балла |
| Пайплайны должны содержать этап трансформации данных | 1 балл |
| Хранящиеся данные чистые: не имеют дублей, корректно партиционированы, поддаются аналитике | 2 балла |
| Пайплайны для репликации в PostgreSQL + Airflow описаны в документации | 0.5 балла |

### Критерии оценивания дополнительного задания  
| Условие | Баллы |
|---------|--------|
| Сформированы пайплайны для создания аналитических витрин в Airflow | 1 балл |
| Создано не менее 2-х аналитических витрин в Airflow | 1 балл |

**Итого:** 10 баллов  

## Итоговое домашнее задание выполнено, если:  
- Файл с заданием прикреплён или к нему есть доступ по ссылке.
- Все этапы процесса, согласно критериям оценивания основного задания, выполнены.
- Все этапы процесса, согласно критериям оценивания дополнительного задания, выполнены (при желании получить максимально возможный балл).
- Система работоспособна.

## Дедлайн  
**13.03.25**  

---

# Описание задания  
## 1. Генерация данных  
Создайте нереляционную базу данных, например MongoDB, и заполните её данными.  

### Примеры сущностей в базах данных  
#### Нереляционная база данных (MongoDB):  

#### 1. UserSessions (сессии пользователей):  
- `session_id` — уникальный идентификатор сессии
- `user_id` — идентификатор пользователя
- `start_time` — время начала сессии
- `end_time` — время завершения сессии
- `pages_visited` — массив посещённых страниц
- `device` — информация об устройстве
- `actions` — массив действий пользователя

#### 2. ProductPriceHistory (история изменения цен):  
- `product_id` — идентификатор товара
- `price_changes` — массив изменений цен с датами
- `current_price` — текущая цена
- `currency` — валюта

#### 3. EventLogs (логи событий):  
- `event_id` — уникальный идентификатор события
- `timestamp` — время события
- `event_type` — тип события
- `details` — подробности

#### 4. SupportTickets (обращения в поддержку):  
- `ticket_id` — уникальный идентификатор тикета
- `user_id` — идентификатор пользователя
- `status` — статус тикета
- `issue_type` — тип проблемы
- `messages` — массив сообщений
- `created_at` — время создания тикета
- `updated_at` — время последнего обновления

#### 5. UserRecommendations (рекомендации пользователям):  
- `user_id` — идентификатор пользователя
- `recommended_products` — массив рекомендованных товаров
- `last_updated` — время последнего обновления рекомендаций

#### 6. ModerationQueue (очередь модерации отзывов):  
- `review_id` — идентификатор отзыва
- `user_id` — идентификатор пользователя
- `product_id` — идентификатор товара
- `review_text` — текст отзыва
- `rating` — оценка
- `moderation_status` — статус модерации
- `flags` — массив флагов
- `submitted_at` — время, когда был оставлен отзыв

#### 7. SearchQueries (поисковые запросы):  
- `query_id` — уникальный идентификатор запроса
- `user_id` — идентификатор пользователя
- `query_text` — текст запроса
- `timestamp` — время запроса
- `filters` — применённые фильтры
- `results_count` — количество найденных результатов

## 2. Репликация данных  
Настройте репликацию сгенерированных данных из MongoDB в PostgreSQL с использованием Airflow.  

На этом этапе необходимо:
- Настроить репликацию
- Проверить данные
- Описать процесс в документации

---

# Дополнительное задание (выполняется при желании получить максимально возможный балл)  
## 1. Построение аналитических витрин  
На основе данных в PostgreSQL создайте не менее 2-х аналитических витрин.  

**Примеры витрин:**
- Витрина активности пользователей для анализа поведения пользователя сервиса.
- Витрина эффективности работы поддержки.

## 2. Использование Airflow  
Настройте пайплайны для репликации данных и формирования аналитических витрин.